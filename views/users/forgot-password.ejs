<%- layout("/layouts/boilerplate") %>
    <div class="row">
        <div class="col-8 offset-2">
            <h1>Forgot Password</h1><br>
            
            <!-- Flash Messages -->
            <% if (typeof locals !== 'undefined' && locals.success) { %>
                <div class="alert alert-success alert-dismissible fade show" role="alert">
                    <i class="fas fa-check-circle me-2"></i>
                    <strong>Success!</strong> <%= locals.success %>
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            <% } %>
            
            <% if (typeof locals !== 'undefined' && locals.error) { %>
                <div class="alert alert-danger alert-dismissible fade show" role="alert">
                    <i class="fas fa-exclamation-circle me-2"></i>
                    <strong>Error!</strong> <%= locals.error %>
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            <% } %>
            
            <% if (typeof locals !== 'undefined' && locals.info) { %>
                <div class="alert alert-info alert-dismissible fade show" role="alert">
                    <i class="fas fa-info-circle me-2"></i>
                    <strong>Info:</strong> <%= locals.info %>
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            <% } %>

            <form method="post" action="/forgot-password" class="needs-validation" novalidate>
                <div class="mb-3">
                    <label for="email" class="form-label">Email Address</label>
                    <input type="email" 
                           name="email" 
                           placeholder="Enter your email address" 
                           class="form-control"
                           id="email" 
                           required 
                           autocomplete="email" />
                </div>
                <br>
                <button type="submit" class="btn btn-success">Send Reset OTP</button>
            </form>
            
            <div class="text-center mt-3 btn btn-dark">
                <a href="/login" class="text-decoration-none text-white">Back to Login</a>
            </div>
            
        </div>
    </div>


    <script>
        (function() {
            'use strict';
            window.addEventListener('load', function() {
                var forms = document.getElementsByClassName('needs-validation');
                Array.prototype.filter.call(forms, function(form) {
                    form.addEventListener('submit', function(event) {
                        if (form.checkValidity() === false) {
                            event.preventDefault();
                            event.stopPropagation();
                        }
                        form.classList.add('was-validated');
                    }, false);
                });
            }, false);
        })();

        document.addEventListener('DOMContentLoaded', function () {
            var emailInput = document.getElementById('email');
            if (!emailInput) return;
            emailInput.addEventListener('input', function() {
                var email = this.value;
                var emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                this.setCustomValidity(email && !emailRegex.test(email) ? 'Please enter a valid email address' : '');
            });
        });
    </script>